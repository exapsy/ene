kind: e2e_test:v1
name: api-tests

fixtures:
  - content_type_inline: "application/json; charset=utf-8"

units:
  - name: mongodb
    kind: mongo
    image: mongo:6.0
    migrations: db.js
    app_port: 27017
    startup_timeout: 15s
  - name: app
    kind: httpmock
    app_port: 8080
    routes:
      - path: /healthcheck
        method: GET
        response:
          status: 200
          body:
            data: ok
          headers:
            Content-Type: "{{ content_type_inline }}"

target: app

tests:
  - name: ping
    kind: http
    request:
      path: /v1/health
      method: GET
      timeout: 5s
    expect:
      status_code: 200
      body_asserts:
        data: "ok"
      header_asserts:
        Content-Type: "{{ content_type_inline }}"
